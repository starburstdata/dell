

<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#0672CB">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', ' UA-114610397-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Installation &#8212; Dell Data Analytics Engine</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/algolia.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/dell.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/search.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/main.js"></script>
    <script src="../../_static/algolia.js"></script>
    <script src="../../_static/searchbox.js"></script>
    <script src="../../_static/searchresults.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gateway API" href="gateway-api.html" />
    <link rel="prev" title="Starburst Gateway" href="index.html" />

  
   

<meta name="robots" content="none">
<meta name="googlebot" content="none">
<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">


<!-- Always link to the latest version, as canonical -->
<link rel="canonical" href="https://docs.starburst.io/latest/admin/starburst-gateway/installation.html">

  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#admin/starburst-gateway/installation" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <span
          title="Dell Data Analytics Engine"
          class="md-header-nav__button md-logo"
          style="cursor: default"
        >
          
          <img
            src="../../_static/dell.png"
            alt="Dell Data Analytics Engine 474-e.1 LTS logo"
          />
          
        </span>
      </div>
      <span class="header-divider"></span>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label
          class="md-icon md-icon--menu md-header-nav__button"
          for="__drawer"
        ></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div
          class="md-flex__ellipsis md-header-nav__title"
          data-md-component="title"
        >
          Installation
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label
          class="md-icon md-icon--search md-header-nav__button"
          for="__search"
        ></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
       
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>


  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../admin.html" class="md-tabs__link">Performance, logging, and governance features</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Starburst Gateway</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="Dell Data Analytics Engine" class="md-nav__button md-logo">
      
        <img src="../../_static/dell.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="Dell Data Analytics Engine">Dell Data Analytics Engine 474-e.1 LTS</a>
  </label>
  
  
  <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../get-started/starburst-enterprise.html">What is Starburst Enterprise?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../learn/index.html">Learn Starburst Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versions.html">Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.starburst.io/support.html">Get support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For all users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/sep-ui.html">Starburst Enterprise web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client.html">Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-products.html">Data products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../insights.html">Insights</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Dell Data Processing Engine users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dell-data-processing-engine/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dell-data-processing-engine/cli.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dell-data-processing-engine/api.html">Dell Data Processing Engine API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dell-data-processing-engine/release-notes.html">Release notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use SQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language.html">SQL language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sql.html">SQL statement syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions.html">Functions and operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../udf.html">User-defined functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For data engineers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../catalogs.html">Define catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage.html">Object storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-engineering/materialized-views.html">Materialized views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-engineering/data-maintenance.html">Data maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optimizer.html">Query optimizer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Connect to data sources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../connector.html">Connector overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage-connectors.html">Object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-object-storage-connectors.html">Non-object storage connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community-connectors.html">Community-supported connectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../connector/starburst-connectors.html">Starburst connectors feature matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-engineering/cost-and-performance/index.html">Monitor and manage cost and performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For platform administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-topics.html">Administration topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin.html">Performance, logging, and governance features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../starburst-rest-api.html">Starburst Enterprise REST API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEP deployment mechanisms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license-requirements.html">Starburst Enterprise license</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../k8s.html">Deploy with Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Manual installation and license</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../develop.html">Trino developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html">Version-specific notices and information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html#topic-areas">Topic areas</a></li>
</ul>
  
  
</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#admin-starburst-gateway-installation--page-root" class="md-nav__link">Installation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#backend-database" class="md-nav__link">Backend database</a>
        </li>
        <li class="md-nav__item"><a href="#starburst-clusters" class="md-nav__link">Starburst clusters</a>
        </li>
        <li class="md-nav__item"><a href="#sep-configuration" class="md-nav__link">SEP Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#secrets-in-configuration-file" class="md-nav__link">Secrets in configuration file</a>
        </li>
        <li class="md-nav__item"><a href="#configure-routing-rules" class="md-nav__link">Configure routing rules</a>
        </li>
        <li class="md-nav__item"><a href="#configure-logging" class="md-nav__link">Configure logging <a name="logging"></a></a>
        </li>
        <li class="md-nav__item"><a href="#configure-additional-v1-statement-like-paths" class="md-nav__link">Configure additional v1/statement-like paths</a>
        </li>
        <li class="md-nav__item"><a href="#configure-behind-a-load-balancer" class="md-nav__link">Configure behind a load balancer</a>
        </li>
        <li class="md-nav__item"><a href="#configure-larger-proxy-response-size" class="md-nav__link">Configure larger proxy response size</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#deploy-starburst-gateway" class="md-nav__link">Deploy Starburst Gateway</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#access-the-helm-chart" class="md-nav__link">Access the Helm Chart</a>
        </li>
        <li class="md-nav__item"><a href="#create-a-secret" class="md-nav__link">Create a secret</a>
        </li>
        <li class="md-nav__item"><a href="#deploy-a-postgresql-database" class="md-nav__link">Deploy a PostgreSQL database</a>
        </li>
        <li class="md-nav__item"><a href="#install-starburst-gateway" class="md-nav__link">Install Starburst Gateway</a>
        </li>
        <li class="md-nav__item"><a href="#access-the-starburst-gateway-ui" class="md-nav__link">Access the Starburst Gateway UI</a>
        </li>
        <li class="md-nav__item"><a href="#additional-options" class="md-nav__link">Additional options</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#health-checks" class="md-nav__link">Health checks</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#info-api-default" class="md-nav__link">INFO_API (default)</a>
        </li>
        <li class="md-nav__item"><a href="#metrics" class="md-nav__link">METRICS</a>
        </li>
        <li class="md-nav__item"><a href="#jdbc" class="md-nav__link">JDBC</a>
        </li>
        <li class="md-nav__item"><a href="#jmx" class="md-nav__link">JMX</a>
        </li>
        <li class="md-nav__item"><a href="#ui-api" class="md-nav__link">UI_API</a>
        </li>
        <li class="md-nav__item"><a href="#noop" class="md-nav__link">NOOP</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="installation">
<h1 id="admin-starburst-gateway-installation--page-root">Installation<a class="headerlink" href="#admin-starburst-gateway-installation--page-root" title="Permalink to this heading">#</a></h1>
<p>Install Starburst Gateway with <a class="reference internal" href="#gateway-helm">Helm</a>.</p>
<p>Use the following instructions to configure and deploy Starburst Gateway.</p>
<section id="configuration">
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">#</a></h2>
<p>The following sections describe the things you need for your configuration.</p>
<p>Each component of the Starburst Gateway has a corresponding node in the
configuration YAML file.</p>
<section id="backend-database">
<span id="gateway-backend-database"></span><h3 id="backend-database">Backend database<a class="headerlink" href="#backend-database" title="Permalink to this heading">#</a></h3>
<p>Starburst Gateway requires a MySQL, PostgreSQL, or Oracle database. Database
initialization is performed automatically when the Starburst Gateway process
starts.</p>
</section>
<section id="starburst-clusters">
<h3 id="starburst-clusters">Starburst clusters<a class="headerlink" href="#starburst-clusters" title="Permalink to this heading">#</a></h3>
<p>Starburst Galaxy and the current and previous Starburst Enterprise LTS versions are compatible
with Starburst Gateway.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starburst Gateway is not compatible with Trino or Amazon Athena.</p>
</div>
</section>
<section id="sep-configuration">
<h3 id="sep-configuration">SEP Configuration<a class="headerlink" href="#sep-configuration" title="Permalink to this heading">#</a></h3>
<p>From a users perspective Starburst Gateway acts as a transparent proxy for one
or more clusters. The following configuration tips should be
taken into account for all clusters behind the Starburst Gateway.</p>
<p>If all client and server communication is routed through Starburst Gateway,
then process forwarded HTTP headers must be enabled:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">http-server.process-forwarded</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
<p>Without this setting, first requests go from the user to Starburst Gateway and then
to SEP correctly. However, the URL for subsequent next URIs for more results
in a query provided by SEP is then using the local URL of the cluster,
and not the URL of the Starburst Gateway. This circumvents the Starburst Gateway for all
these requests. In scenarios, where the local URL of the SEP cluster is private
to the cluster on the network level, these following calls do not work
at all for users.</p>
<p>This setting is also required for SEP to authenticate in the case TLS is
terminated at the Starburst Gateway. Normally it refuses to authenticate plain HTTP
requests, but if <code class="docutils literal notranslate"><span class="pre">http-server.process-forwarded=true</span></code> it authenticates over
HTTP if the request includes <code class="docutils literal notranslate"><span class="pre">X-Forwarded-Proto:</span> <span class="pre">HTTPS</span></code>.</p>
<p>Starburst Galaxy requires setting</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">routing</span><span class="p">:</span>
  <span class="nt">addXForwardedHeaders</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>to prevent Starburst Gateway from sending <code class="docutils literal notranslate"><span class="pre">X-Forwarded-*</span></code> headers. This setting
is required to be <code class="docutils literal notranslate"><span class="pre">true</span></code> when proxying clusters that are behind firewalls or
otherwise not directly routable from the SQL client.</p>
</section>
<section id="secrets-in-configuration-file">
<h3 id="secrets-in-configuration-file">Secrets in configuration file<a class="headerlink" href="#secrets-in-configuration-file" title="Permalink to this heading">#</a></h3>
<p>Environment variables can be used as values in the configuration file.
You can manually set an environment variable on the command line.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">DB_PASSWORD</span><span class="o">=</span>my-super-secret-pwd
</pre></div>
</div>
<p>To use this variable in the configuration file, you reference it with the
syntax <code class="docutils literal notranslate"><span class="pre">${ENV:VARIABLE}</span></code>. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dataStore</span><span class="p">:</span>
  <span class="nt">jdbcUrl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jdbc:postgresql://localhost:5432/gateway</span>
  <span class="nt">user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">postgres</span>
  <span class="nt">password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${ENV:DB_PASSWORD}</span>
</pre></div>
</div>
</section>
<section id="configure-routing-rules">
<h3 id="configure-routing-rules">Configure routing rules<a class="headerlink" href="#configure-routing-rules" title="Permalink to this heading">#</a></h3>
<p>Find more information in the <a class="reference internal" href="routing-rules.html"><span class="std std-doc">routing rules documentation</span></a>.</p>
</section>
<section id="configure-logging">
<h3 id="configure-logging">Configure logging <a name="logging"><a class="headerlink" href="#configure-logging" title="Permalink to this heading">#</a></a></h3>
<p>To configure the logging level for various classes, specify the path to the
<code class="docutils literal notranslate"><span class="pre">log.properties</span></code> file by setting <code class="docutils literal notranslate"><span class="pre">log.levels-file</span></code> in <code class="docutils literal notranslate"><span class="pre">serverConfig</span></code>.</p>
<p>For additional configurations, use the <code class="docutils literal notranslate"><span class="pre">log.*</span></code> properties from the
<a class="reference internal" href="../properties-logging.html"><span class="doc">logging properties documentation</span></a> and specify
the properties in <code class="docutils literal notranslate"><span class="pre">serverConfig</span></code>.</p>
</section>
<section id="configure-additional-v1-statement-like-paths">
<h3 id="configure-additional-v1-statement-like-paths">Configure additional v1/statement-like paths<a class="headerlink" href="#configure-additional-v1-statement-like-paths" title="Permalink to this heading">#</a></h3>
<p>The SEP client protocol specifies that queries are initiated by a POST to <code class="docutils literal notranslate"><span class="pre">v1/statement</span></code>.
The Starburst Gateway incorporates this into its routing logic by extracting and recording the
query id from responses to such requests. If you use an experimental or commercial build of
SEP that supports additional endpoints, you can cause Starburst Gateway to treat them
equivalently to <code class="docutils literal notranslate"><span class="pre">/v1/statement</span></code> by adding them under the <code class="docutils literal notranslate"><span class="pre">additionalStatementPaths</span></code>
configuration node. They must be absolute, and no path can be a prefix to any other path.
The standard <code class="docutils literal notranslate"><span class="pre">/v1/statement</span></code> path is always included and does not need to be configured.
For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">additionalStatementPaths</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="s">'/ui/api/insights/ide/statement'</span>
</pre></div>
</div>
</section>
<section id="configure-behind-a-load-balancer">
<h3 id="configure-behind-a-load-balancer">Configure behind a load balancer<a class="headerlink" href="#configure-behind-a-load-balancer" title="Permalink to this heading">#</a></h3>
<p>A possible deployment of Starburst Gateway is to run multiple instances of Starburst
Gateway behind another generic load balancer, such as a load balancer from
your cloud hosting provider. In this deployment you must configure the
<code class="docutils literal notranslate"><span class="pre">serverConfig</span></code> to include enabling process forwarded HTTP headers:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">serverConfig</span><span class="p">:</span>
  <span class="nt">http-server.process-forwarded</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="configure-larger-proxy-response-size">
<h3 id="configure-larger-proxy-response-size">Configure larger proxy response size<a class="headerlink" href="#configure-larger-proxy-response-size" title="Permalink to this heading">#</a></h3>
<p>Starburst Gateway reads the response from SEP in bytes (up to 32MB by default).
It can be configured by setting:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">proxyResponseConfiguration</span><span class="p">:</span>
  <span class="nt">responseSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50MB</span>
</pre></div>
</div>
</section>
</section>
<section id="deploy-starburst-gateway">
<span id="gateway-helm"></span><h2 id="deploy-starburst-gateway">Deploy Starburst Gateway<a class="headerlink" href="#deploy-starburst-gateway" title="Permalink to this heading">#</a></h2>
<p>Use the following steps to deploy Starburst Gateway on Kubernetes with Helm.</p>
<p>The Starburst Gateway Helm chart includes:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">config</span></code> node for general configuration</p></li>
<li><p>Standard Helm options such as <code class="docutils literal notranslate"><span class="pre">replicaCount</span></code>, <code class="docutils literal notranslate"><span class="pre">resources</span></code>, and <code class="docutils literal notranslate"><span class="pre">ingress</span></code></p></li>
</ul>
<section id="access-the-helm-chart">
<h3 id="access-the-helm-chart">Access the Helm Chart<a class="headerlink" href="#access-the-helm-chart" title="Permalink to this heading">#</a></h3>
<p>The Starburst Gateway Helm chart is available in the <a class="reference external" href="https://harbor.starburstdata.net/">Starburst Helm chart
project</a>.</p>
<p>Use the following commands to access the chart:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>helm registry login harbor.starburstdata.net/starburstdata
<span class="c1"># Enter your credentials</span>
helm pull oci://harbor.starburstdata.net/starburstdata/charts/starburst-gateway --version <span class="m">472</span>.0.0
</pre></div>
</div>
</section>
<section id="create-a-secret">
<h3 id="create-a-secret">Create a secret<a class="headerlink" href="#create-a-secret" title="Permalink to this heading">#</a></h3>
<p>Use the following command to create a secret for Harbor registry authentication:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl create secret docker-registry harbor-auth <span class="se">\</span>
  --docker-server<span class="o">=</span>harbor.starburstdata.net <span class="se">\</span>
  --docker-username<span class="o">=</span>&lt;your-username&gt; <span class="se">\</span>
  --docker-password<span class="o">=</span>&lt;your-password&gt; <span class="se">\</span>
  --docker-email<span class="o">=</span>&lt;your-email&gt;
</pre></div>
</div>
</section>
<section id="deploy-a-postgresql-database">
<h3 id="deploy-a-postgresql-database">Deploy a PostgreSQL database<a class="headerlink" href="#deploy-a-postgresql-database" title="Permalink to this heading">#</a></h3>
<p>Use the following command to create a PostgreSQL pod:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl apply -f val-posgres.yaml
</pre></div>
</div>
</section>
<section id="install-starburst-gateway">
<h3 id="install-starburst-gateway">Install Starburst Gateway<a class="headerlink" href="#install-starburst-gateway" title="Permalink to this heading">#</a></h3>
<p>Use the following command to install Starburst Gateway:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>helm upgrade --install starburst-gateway starburst-gateway-472.0.0.tgz -f gateway-config.yaml
</pre></div>
</div>
</section>
<section id="access-the-starburst-gateway-ui">
<h3 id="access-the-starburst-gateway-ui">Access the Starburst Gateway UI<a class="headerlink" href="#access-the-starburst-gateway-ui" title="Permalink to this heading">#</a></h3>
<p>User the following command to access the Starburst Gateway UI:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl port-forward service/starburst-gateway <span class="m">8080</span>:8080
</pre></div>
</div>
<p>Then, access the UI at http://localhost:8080.</p>
</section>
<section id="additional-options">
<h3 id="additional-options">Additional options<a class="headerlink" href="#additional-options" title="Permalink to this heading">#</a></h3>
<p>To implement static routing rules, create a ConfigMap from your routing rules yaml
definition:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>kubectl create cm routing-rules --from-file your-routing-rules.yaml
</pre></div>
</div>
<p>Then mount it to your container:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">volumes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
      <span class="nt">configMap</span><span class="p">:</span>
          <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
          <span class="nt">items</span><span class="p">:</span>
              <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
              <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>

<span class="nt">volumeMounts</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">routing-rules</span>
      <span class="nt">mountPath</span><span class="p">:</span> <span class="s">"/etc/routing-rules/your-routing-rules.yaml"</span>
      <span class="nt">subPath</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">your-routing-rules.yaml</span>
</pre></div>
</div>
<p>Ensure that the <code class="docutils literal notranslate"><span class="pre">mountPath</span></code> matches the <code class="docutils literal notranslate"><span class="pre">rulesConfigPath</span></code> specified in your
configuration. Note that the <code class="docutils literal notranslate"><span class="pre">subPath</span></code> is not strictly necessary, and if it
is not specified the file is mounted at <code class="docutils literal notranslate"><span class="pre">mountPath/&lt;configMap</span> <span class="pre">key&gt;</span></code>.</p>
<p>Standard Helm options such as <code class="docutils literal notranslate"><span class="pre">replicaCount</span></code>, <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">imagePullSecrets</span></code>,
<code class="docutils literal notranslate"><span class="pre">service</span></code>, <code class="docutils literal notranslate"><span class="pre">ingress</span></code> and <code class="docutils literal notranslate"><span class="pre">resources</span></code> are supported. These are defined in
<code class="docutils literal notranslate"><span class="pre">helm/values.yaml</span></code>.</p>
</section>
</section>
<section id="health-checks">
<h2 id="health-checks">Health checks<a class="headerlink" href="#health-checks" title="Permalink to this heading">#</a></h2>
<p>Starburst Gateway periodically performs health checks and maintains an in-memory
health status for each backend. If a backend fails a health check, it is marked
as <code class="docutils literal notranslate"><span class="pre">UNHEALTHY</span></code>, and Starburst Gateway stops routing requests to it.</p>
<p>It is important to distinguish health status from the active/inactive
state of a backend. The active/inactive state indicates whether a backend is
manually turned on or off, whereas health status is programmatically determined
by the health check process. Health checks are only performed on backends
that are marked as active.</p>
<p>Starburst recommends using either <code class="docutils literal notranslate"><span class="pre">INFO_API</span></code> or <code class="docutils literal notranslate"><span class="pre">METRICS</span></code> for your health check.
Other options may be deprecated in the future.</p>
<p>See <a class="reference internal" href="routing-rules.html#gateway-healthstatus"><span class="std std-ref">health status</span></a> for more details on
what each status means.</p>
<p>The type of health check is configured by setting</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">clusterStatsConfiguration</span><span class="p">:</span>
  <span class="nt">monitorType</span><span class="p">:</span> <span class="s">""</span>
</pre></div>
</div>
<p>to one of the following values.</p>
<section id="info-api-default">
<h3 id="info-api-default">INFO_API (default)<a class="headerlink" href="#info-api-default" title="Permalink to this heading">#</a></h3>
<p>By default Starburst Gateway uses the <code class="docutils literal notranslate"><span class="pre">v1/info</span></code> REST endpoint. A successful check is
defined as a 200 response with <code class="docutils literal notranslate"><span class="pre">starting:</span> <span class="pre">false</span></code>. Connection timeout parameters
can be defined through the <code class="docutils literal notranslate"><span class="pre">monitor</span></code> node, for example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
  <span class="nt">connectTimeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
  <span class="nt">requestTimeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
  <span class="nt">idleTimeoutSeconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">retries</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>All timeout parameters are optional.</p>
</section>
<section id="metrics">
<h3 id="metrics">METRICS<a class="headerlink" href="#metrics" title="Permalink to this heading">#</a></h3>
<p>This pulls statistics from Trinoâ€™s <a class="reference external" href="https://openmetrics.io/">OpenMetrics</a> endpoint.
It retrieves the number of running and queued queries for use with
the <code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code> (either <code class="docutils literal notranslate"><span class="pre">METRICS</span></code> or <code class="docutils literal notranslate"><span class="pre">JDBC</span></code> must be enabled if
<code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouter</span></code> is used).</p>
<p>By default, it uses the <code class="docutils literal notranslate"><span class="pre">trino_execution_name_QueryManager_RunningQueries</span></code> and
<code class="docutils literal notranslate"><span class="pre">trino_execution_name_QueryManager_QueuedQueries</span></code> to track the number of running
and queued queries respectively, however these metrics can be configured as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
    <span class="nt">runningQueriesMetricName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">io_starburst_galaxy_name_GalaxyMetrics_RunningQueries</span>
    <span class="nt">queuedQueriesMetricName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">io_starburst_galaxy_name_GalaxyMetrics_QueuedQueries</span>
</pre></div>
</div>
<p>Similarly, by default the monitor pulls the metrics using the <code class="docutils literal notranslate"><span class="pre">/metrics</span></code> endpoint, but it
can be updated to use another one:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
    <span class="nt">metricsEndpoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/v1/metrics</span>
</pre></div>
</div>
<p>This monitor allows customizing health definitions by comparing metrics to fixed
values. This is configured through two maps: <code class="docutils literal notranslate"><span class="pre">metricMinimumValues</span></code> and
<code class="docutils literal notranslate"><span class="pre">metricMaximumValues</span></code>. The keys of these maps are the metric names, and the values
are the minimum or maximum values (inclusive) that are considered healthy. By default,
the only metric populated is:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
    <span class="nt">metricMinimumValues</span><span class="p">:</span>
        <span class="nt">trino_metadata_name_DiscoveryNodeManager_ActiveNodeCount</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>This requires the cluster to have at least one active worker node in order to be considered
healthy. The map is overwritten if configured explicitly. For example, to increase the minimum
worker count to 10 and disqualify clusters that have been experiencing frequent major Garbage
Collections, set</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
    <span class="nt">metricMinimumValues</span><span class="p">:</span>
        <span class="nt">trino_metadata_name_DiscoveryNodeManager_ActiveNodeCount</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    <span class="nt">metricMaximumValues</span><span class="p">:</span>
        <span class="nt">io_airlift_stats_name_GcMonitor_MajorGc_FiveMinutes_count</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
</pre></div>
</div>
</section>
<section id="jdbc">
<h3 id="jdbc">JDBC<a class="headerlink" href="#jdbc" title="Permalink to this heading">#</a></h3>
<p>This uses a JDBC connection to query <code class="docutils literal notranslate"><span class="pre">system.runtime</span></code> tables for cluster
information. It is required for the query count based routing strategy. This is
recommended over <code class="docutils literal notranslate"><span class="pre">UI_API</span></code> since it does not restrict the Web UI authentication
method of backend clusters. Configure a username and password by adding
<code class="docutils literal notranslate"><span class="pre">backendState</span></code> to your configuration. The username and password must be valid
across all backends.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">backendState</span><span class="p">:</span>
  <span class="nt">username</span><span class="p">:</span> <span class="s">"user"</span>
  <span class="nt">password</span><span class="p">:</span> <span class="s">"password"</span>
</pre></div>
</div>
<p>Starburst Gateway uses <code class="docutils literal notranslate"><span class="pre">explicitPrepare=false</span></code> by default. This property was introduced
in Trino 431, and uses a single query for prepared statements, instead of a
<code class="docutils literal notranslate"><span class="pre">PREPARE/EXECUTE</span></code> pair. If you are using the JDBC health check option with older
versions of Trino, set</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
   <span class="nt">explicitPrepare</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>The query timeout can be set through</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">monitor</span><span class="p">:</span>
    <span class="nt">queryTimeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
<p>Other timeout parameters are not applicable to the JDBC connection.</p>
</section>
<section id="jmx">
<h3 id="jmx">JMX<a class="headerlink" href="#jmx" title="Permalink to this heading">#</a></h3>
<p>The monitor type <code class="docutils literal notranslate"><span class="pre">JMX</span></code> can be used as an alternative to collect cluster information,
which is required for the <code class="docutils literal notranslate"><span class="pre">QueryCountBasedRouterProvider</span></code>. This uses the <code class="docutils literal notranslate"><span class="pre">v1/jmx/mbean</span></code>
endpoint on clusters.</p>
<p>To enable this, you must activate <a class="reference internal" href="../jmx.html"><span class="doc">JMX monitoring</span></a> on all Trino clusters:</p>
<div class="highlight-properties notranslate"><div class="highlight"><pre><span></span><span class="na">jmx.rmiregistry.port</span><span class="o">=</span><span class="s">&lt;port&gt;</span>
<span class="na">jmx.rmiserver.port</span><span class="o">=</span><span class="s">&lt;port&gt;</span>
</pre></div>
</div>
<p>Allow JMX endpoint access by adding rules to your <a class="reference external" href="https://trino.io/docs/current/security/file-system-access-control.html">file-based access control</a>
configuration. Example for <code class="docutils literal notranslate"><span class="pre">user</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"catalogs"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"user"</span><span class="p">,</span>
      <span class="nt">"catalog"</span><span class="p">:</span> <span class="s2">"system"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="s2">"read-only"</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">"system_information"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">"user"</span><span class="p">:</span> <span class="s2">"user"</span><span class="p">,</span>
      <span class="nt">"allow"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"read"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ensure that a username and password are configured by adding the <code class="docutils literal notranslate"><span class="pre">backendState</span></code>
section to your configuration. The credentials must be consistent across all
backend clusters and have <code class="docutils literal notranslate"><span class="pre">read</span></code> rights on the <code class="docutils literal notranslate"><span class="pre">system_information</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">backendState</span><span class="p">:</span>
  <span class="nt">username</span><span class="p">:</span> <span class="s">"user"</span>
  <span class="nt">password</span><span class="p">:</span> <span class="s">"password"</span>
</pre></div>
</div>
<p>The JMX monitor will use these credentials to authenticate against the
JMX endpoint of each cluster and collect metrics like running queries,
queued queries, and worker nodes information.</p>
</section>
<section id="ui-api">
<h3 id="ui-api">UI_API<a class="headerlink" href="#ui-api" title="Permalink to this heading">#</a></h3>
<p>This pulls cluster information from the <code class="docutils literal notranslate"><span class="pre">ui/api/stats</span></code> REST endpoint. This is
supported for legacy reasons and may be deprecated in the future. It is only
supported for backend clusters with <code class="docutils literal notranslate"><span class="pre">web-ui.authentication.type=FORM</span></code>. Set
a username and password using <code class="docutils literal notranslate"><span class="pre">backendState</span></code> as with the <code class="docutils literal notranslate"><span class="pre">JDBC</span></code> option.</p>
</section>
<section id="noop">
<h3 id="noop">NOOP<a class="headerlink" href="#noop" title="Permalink to this heading">#</a></h3>
<p>This option disables health checks.</p>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>

  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="index.html" title="Starburst Gateway"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Starburst Gateway </span>
              </div>
            </a>
          
          
            <a href="gateway-api.html" title="Gateway API"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Gateway API </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
<!-- custom footer should go here in time -->
<div class="page-footer">
</div>
<script src="../_static/algolia.js"></script>
<script src="../_static/searchbox.js"></script>
<script src="../_static/searchresults.js"></script>
  </body>
</html>